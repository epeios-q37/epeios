# ZNDq

*Zend* (*PHP*) native extensions wrapper.


For more information, see [http://q37.info/tools/zndq/](http://q37.info/tools/zndq/).

*GNU/Linux*: [![Travis CI](https://travis-ci.org/epeios-q37/zndq.png)](https://travis-ci.org/epeios-q37/zndq)
 
*Windows*: [![AppVeyor](http://ci.appveyor.com/api/projects/status/github/epeios-q37/zndq)](http://ci.appveyor.com/project/epeios-q37/zndq)

----------

*For the core developer and maintainer*

## *POSIX*

For *POSIX* systems, you have to use the standard procedure for *PHP* extensions, namely :
 - `phpize`,
 - `./configure`,
 - `make`.

To generate the right `config.m4` file, launch `DVLGenM4`.

It should be possible to replace the `epeios` directory in the `config.m4` file with a macro, but there is a flaw in the generation of the `Makefile` when using `./configure`, which not correctly handles macro containing a dot (`.`). The macro can also not contain an absolute path. This leads to the creation of a link from the *stable* directory for the *Epeios* framework to the `epeios` path in this tool's development directory.  

## *Windows*

To generate the files for *Visual Studio*, use the usual `DVLGenVC` command.

This command is enough to regenerate the `zndq.vcxproj(.filters)]` files. However, if there is a change in the procedure which generates the files to build a *PHP* extension under *Windows*, you have to adapt the proper files used by the `DVLGenVC` command. For this, you probably will need a file named `config.w32`. This file can be found under the `config.w32` directory (it has to be in a sub-directory in order to be take in account), and is also generated by the `DVLGenM4`command.

Note that this `config.w32` file is needed by *AppVeyor*.

To compile *PHP*, open a *DOS* (not a *Cygwin* one) console in the *PHP* source directory and launch :
- `"C:\Program Files (x86)\Microsoft Visual Studio\2017\Community\VC\Auxiliary\Build\vcvars64.bat"`,
- `set PATH=%PATH%;C:\Program Files (x86)\GnuWin32\bin`
- `buildconf.bat`
- `configure.bat`
- `nmake --disable-all --enable-cli`.